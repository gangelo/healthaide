<div id="food_qualifiers" class="food-qualifiers">
  <h3 class="text-2xl font-semibold mt-6 mb-4">Qualifiers</h3>

  <%= render "qualifier_list", food: @food %>

  <h4 class="text-xl font-semibold mb-3">Add a Qualifier</h4>

  <%= render "add_existing_qualifier_form", food: @food, available_qualifiers: @available_qualifiers %>

  <div class="mt-4 border-t pt-4">
    <h5 class="font-medium mb-2"><%= @available_qualifiers.any? ? "Or create a new qualifier:" : "Create a new qualifier:" %></h5>

    <div data-controller="food-qualifier">
      <div id="errorMessage" class="bg-red-100 text-red-700 p-2 mb-2 rounded hidden" data-food-qualifier-target="errorMessage"></div>

      <%= turbo_frame_tag "new_qualifier" do %>
        <%= form_with url: find_or_create_food_qualifiers_path, method: :post,
                    data: { action: "submit->food-qualifier#validateForm" } do |form| %>
          <div class="flex">
            <%= form.text_field :qualifier_name,
                              class: "flex-grow border rounded px-3 py-2 mr-2",
                              placeholder: "Enter a new qualifier name",
                              required: true,
                              data: { food_qualifier_target: "qualifierName" } %>
            <%= form.submit "Create & Add", class: "bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded" %>
            <%= form.hidden_field :food_id, value: @food.id %>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>
</div>
